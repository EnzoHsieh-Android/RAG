# RAG 書籍推薦系統 - 服務器環境變量配置
# 適用於服務器已運行 Ollama 和 Qdrant 的情況

# ==============================================
# API 配置
# ==============================================

# Gemini API Key (用於智能查詢分析，可選)
# 如果不設置，系統會使用 fallback 語義分析
GEMINI_API_KEY=

# ==============================================
# 連接到現有服務的配置
# ==============================================

# Qdrant 向量數據庫 (連接到宿主機)
QDRANT_HOST=localhost
QDRANT_PORT=6333

# Ollama AI 服務 (連接到宿主機)
OLLAMA_BASE_URL=http://localhost:11434

# ==============================================
# 應用配置
# ==============================================

# Spring 環境配置
SPRING_PROFILES_ACTIVE=server

# 應用端口
APP_PORT=8081

# 管理端點端口
MANAGEMENT_PORT=8082

# ==============================================
# JVM 性能配置 (根據服務器配置調整)
# ==============================================

# 4GB 系統建議配置
JAVA_OPTS=-Xmx3g -Xms1g -XX:+UseG1GC -XX:MaxGCPauseMillis=200 -XX:+UseStringDeduplication

# 8GB 系統建議配置 (取消註釋並註釋上面的配置)
# JAVA_OPTS=-Xmx6g -Xms2g -XX:+UseG1GC -XX:MaxGCPauseMillis=100 -XX:+UseStringDeduplication

# 16GB 系統建議配置 (取消註釋並註釋上面的配置)  
# JAVA_OPTS=-Xmx12g -Xms4g -XX:+UseG1GC -XX:MaxGCPauseMillis=50 -XX:+UseStringDeduplication

# ==============================================
# 緩存和性能配置
# ==============================================

# Embedding 快取配置
CACHE_EMBEDDINGS_MAX_SIZE=100000
CACHE_EMBEDDINGS_EXPIRE_AFTER_WRITE=24h

# 批處理配置
BATCH_SIZE=50
BATCH_PARALLEL_WORKERS=4

# ==============================================
# 數據庫集合配置
# ==============================================

# Qdrant 集合名稱 (應與現有數據匹配)
QDRANT_TAGS_COLLECTION=tags_vecs
QDRANT_DESC_COLLECTION=desc_vecs
QDRANT_VECTOR_SIZE=1024

# ==============================================
# 搜索配置
# ==============================================

# 搜索參數
SEARCH_MAX_RESULTS=100
SEARCH_DEFAULT_THRESHOLD=0.6
SEARCH_TIMEOUT=45s

# ==============================================
# 健康檢查配置
# ==============================================

HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_TIMEOUT_SECONDS=30
HEALTH_CHECK_PERFORMANCE_TESTS=true
HEALTH_CHECK_DATA_INTEGRITY_TESTS=true

# ==============================================
# 日誌配置
# ==============================================

# 日誌等級
LOG_LEVEL_ROOT=INFO
LOG_LEVEL_APP=INFO

# 日誌文件配置
LOG_FILE_NAME=logs/rag-app.log
LOG_FILE_MAX_SIZE=200MB
LOG_FILE_MAX_HISTORY=30
LOG_FILE_TOTAL_SIZE_CAP=5GB

# ==============================================
# HTTP 服務配置
# ==============================================

# Tomcat 配置
SERVER_TOMCAT_MAX_CONNECTIONS=200
SERVER_TOMCAT_MAX_THREADS=200
SERVER_TOMCAT_MIN_SPARE_THREADS=10

# 請求處理配置
SERVER_MAX_HTTP_HEADER_SIZE=8192
SERVER_CONNECTION_TIMEOUT=20s

# ==============================================
# 安全和網路配置
# ==============================================

# CORS 配置 (生產環境請設定具體域名)
ALLOWED_ORIGINS=*
CORS_ENABLED=true

# 管理端點安全配置
MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE=health,info,metrics,env

# ==============================================
# 監控配置
# ==============================================

# 應用監控
MONITORING_ENABLED=true
METRICS_INTERVAL=30s

# ==============================================
# Docker 特殊配置
# ==============================================

# 容器時區
TZ=Asia/Taipei

# ==============================================
# 調試配置 (開發/測試時使用)
# ==============================================

# 設為 true 啟用調試模式
DEBUG_MODE=false

# 調試端口 (當 DEBUG_MODE=true 時)
DEBUG_PORT=5005